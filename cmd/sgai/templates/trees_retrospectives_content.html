<div class="retro-content-embedded">
	<div class="retro-split">
	<div class="retro-panel-embedded" id="retro-panel-embedded">
		{{if .Sessions}}
		{{range .Sessions}}
	<a class="retro-session-item{{if eq .Name $.SelectedSession}} selected{{end}}"
		href="/workspaces/{{$.DirName}}/retro?session={{.Name}}">
		<span class="session-indicator{{if .HasImprovements}} analyzed{{end}}"></span>
		<span class="session-name">{{.Name}}</span>
	</a>
		{{end}}
		{{else}}
		<p class="empty-state">No retrospective sessions found</p>
		{{end}}
		</div>

		<div class="retro-details-embedded" id="retro-details-embedded">
			{{if .Details}}
			<div class="retro-header">
				<h4>{{.Details.SessionName}}</h4>
				<span class="retro-status{{if .Details.HasImprovements}} analyzed{{end}}">
					{{if .Details.HasImprovements}}Analyzed{{else}}Not Analyzed{{end}}
				</span>
			</div>
			<div class="retro-actions">
				{{if not .Details.IsAnalyzing}}
				<form method="POST" action="/workspaces/{{$.DirName}}/retro/analyze">
					<input type="hidden" name="path" value="{{.Details.Directory}}">
					<input type="hidden" name="session" value="{{.Details.SessionName}}">
					<button type="submit">Analyze</button>
				</form>
			{{else}}
			<a href="/workspaces/{{$.DirName}}/retro/{{.Details.SessionName}}/analyze" role="button" class="secondary">View Progress</a>
			{{end}}
		{{if .Details.HasImprovements}}
		{{if not .Details.IsApplying}}
		<a href="/workspaces/{{$.DirName}}/retro/apply-select?session={{.Details.SessionName}}" role="button" class="outline">Apply</a>
		{{else}}
		<button class="outline" aria-busy="true" disabled>Applying...</button>
		{{end}}
		{{end}}
		<button type="button" class="secondary outline"
			hx-post="/workspaces/{{$.DirName}}/retro/delete"
			hx-vals='{"session": "{{.Details.SessionName}}"}'
			hx-confirm="Delete retrospective session '{{.Details.SessionName}}'? This cannot be undone."
			hx-target="#tab-content"
			hx-swap="innerHTML">Delete</button>
		</div>
			{{if .Details.GoalContent}}
			<div class="retro-content-section">
				<h5>GOAL.md</h5>
				<article>{{.Details.GoalContent}}</article>
			</div>
			{{else if .Details.GoalSummary}}
			<div class="retro-content-section">
				<h5>Goal Summary</h5>
				<article><p>{{.Details.GoalSummary}}</p></article>
			</div>
			{{end}}
			{{if .Details.ImprovementsContent}}
			<div class="retro-content-section">
				<h5>IMPROVEMENTS.md</h5>
				<article>{{.Details.ImprovementsContent}}</article>
			</div>
			{{end}}
			{{if not .Details.GoalContent}}
			<div class="retro-content-section">
				<p class="empty-state">No GOAL.md found for this session</p>
			</div>
			{{end}}
			{{else}}
			<p class="empty-state">Select a session to view details</p>
			{{end}}
		</div>
	</div>
</div>

<header>
	<h3>Response Required</h3>
</header>
<p><mark>Agent: {{.AgentName}}</mark></p>
<form method="POST" action="/respond">
	<input type="hidden" name="directory" value="{{.Directory}}">
	<input type="hidden" name="returnTo" value="{{.ReturnTo}}">
	<input type="hidden" name="multichoice" value="true">
	<input type="hidden" name="questionCount" value="{{len .Questions}}">

	{{range $qIndex, $question := .Questions}}
	<div style="margin-bottom: 1.5rem; {{if gt (len $.Questions) 1}}padding-bottom: 1rem; border-bottom: 1px solid var(--pico-muted-border-color);{{end}}">
		{{if gt (len $.Questions) 1}}
		<div style="font-size: 0.875rem; color: var(--pico-muted-color); margin-bottom: 0.5rem;">Question {{add $qIndex 1}} of {{len $.Questions}}</div>
		{{end}}
		<div style="white-space: pre-wrap; margin-bottom: 1rem;">{{$question.Question}}</div>
		<input type="hidden" name="multiSelect_{{$qIndex}}" value="{{$question.MultiSelect}}">

		<fieldset style="margin-bottom: 1rem;">
			<legend>Select your answer{{if $question.MultiSelect}}(s){{end}}:</legend>
			{{range $cIndex, $choice := $question.Choices}}
			<div style="display: flex; align-items: flex-start; gap: 0.5rem; margin-bottom: 0.75rem;">
				{{if $question.MultiSelect}}
				<input type="checkbox" id="modal-choice-{{$qIndex}}-{{$cIndex}}" name="choices_{{$qIndex}}" value="{{$choice}}" style="margin-top: 0.25rem; flex-shrink: 0;">
				{{else}}
				<input type="radio" id="modal-choice-{{$qIndex}}-{{$cIndex}}" name="choices_{{$qIndex}}" value="{{$choice}}" style="margin-top: 0.25rem; flex-shrink: 0;">
				{{end}}
				<label for="modal-choice-{{$qIndex}}-{{$cIndex}}" style="margin: 0; cursor: pointer; overflow: hidden; text-overflow: ellipsis;" data-tooltip="{{$choice}}">{{$choice}}</label>
			</div>
			{{end}}
		</fieldset>
	</div>
	{{end}}

	<div style="margin-top: 1rem; padding-top: 1rem;">
		<label for="modal-other" style="font-weight: 600;">Other (additional comments or alternative answer):</label>
		<textarea name="other" id="modal-other" placeholder="Type your custom response here..." rows="3"></textarea>
	</div>

	<footer>
		<a href="{{.ReturnTo}}" role="button" class="secondary">Cancel</a>
		<button type="submit">Send Response</button>
	</footer>
</form>
{{template "response_context.html" .}}
